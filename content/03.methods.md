## Materials and Methods

### Children's Brain Tumor Tissue Consortium Data

### Pediatric Pacific Neuro-oncology Consortium Data

### Germ Line Single Nucleotide Variant Calling

### Germ Line Copy Number Variant Calling

### Germ Line Structural Variant Calling

### DNA WGS Alignment

We used [BWA MEM](https://arxiv.org/abs/1303.3997) v0.7.17 for alignment of paired-end DNAseq reads.

### RNAseq Alignment

We used [STAR aligner](doi:10.1093/bioinformatics/bts635) v2.6.1d for alignment of paired-end RNAseq reads.

### Somatic Single Nucleotide Variant Calling
**SNV and INDEL Calling**

We used [Strelka2](doi:10.1038/s41592-018-0051-x) v2.9.3 and mutect2 from [Broad's GATK](https://software.broadinstitute.org/gatk/) v4.1.1.0. Strelka2 was run using default parameters on human genome reference hg38, canoncial chromosomes only (chr1-22, X,Y,M), as recommneded hy the author.  Mutect2 was run following Braid best practices outlined from their [WDL](https://github.com/broadinstitute/gatk/blob/4.1.1.0/scripts/mutect2_wdl/mutect2.wdl).  

**VCF Annotation and MAF Creation**

We filtered outputs from both callers on the "PASS" filter, and annotated using [The ENSEMBL Variant Effect Predictor](doi:10.1186/s13059-016-0974-4), reference release 93, and created mafs using [MSKCC's vcf2maf](https://github.com/mskcc/vcf2maf) v1.6.16.

### Somatic Copy Number Variant Calling

We used [Control-FREEC](https://doi.org/10.1093/bioinformatics/btr670) v8.7 for copy number variant calls.

### Somatic Structural Variant Calling

We used [Manta SV](doi:10.1093/bioinformatics/btv710) v1.4.0 for structural variant calls.

### Gene Expression Abundance Estimation

We used [RSEM](https://github.com/deweylab/RSEM) v1.3.1 for transcript- and gene-level quantification.

### RNA Fusion Calling and Prioritization
#### Gene Fusion Detection
We set up [Arriba v1.1.0](https://github.com/suhrig/arriba/) and STAR-Fusion 1.5.0 [@doi:10.1101/120295] fusion detection tools using CWL on CAVATICA.
For both these tools we used aligned BAM and chimeric SAM files from STAR as inputs and GRCh38_gencode_v27 GTF for gene annotation.
We ran STAR-fusion with default paramters and annotated all fusion calls with GRCh38_v27_CTAT_lib_Feb092018.plug-n-play.tar.gz provided in the STAR-fusion release. 
While running arriba, we used the blacklist file blacklist_hg38_GRCh38_2018-11-04.tsv.gz that was provided in the arriba release tarballs to remove recurrent fusion artifacts and transcripts present in healthy tissue.
Additionally we also provided strandedness information to arriba or we set it to auto-detection for polyA samples.

#### Fusion prioritization
We set up a [fusion prioritization pipeline](https://github.com/d3b-center/fusion_filtering_pipeline) to filter and annotate fusion calls as described below.
We used all inframe and frameshift fusion calls with 1 or more junction reads and fused genes expressed at TPM >1 as true calls.
If a fusion call had large number of spanning fragment reads compared to junction reads (if spanning fragment - junction read > 10) or if either 5\` or 3\` genes multi-fused > 5 different genes we removed these calls as a potential false positive. We also removed fusions if the 5\` or 3\` were the same gene which were tagged as non-canonical splicing or duplication.
We used a list of curated list of fusion calls for each histology to capture each occurence of the fusion as a putative driver fusion.
We prioritised a union of fusion calls as true calls if the fused genes were either detected by both callers , or the same fusion was recurrent in histology(>2 samples)  or the fusion was specific to the broad histology. 
The putative driver fusions and prioritized fusions lists were annotated to identify kinases , oncogenic , tumor suppressor, transcription factor ,  fused genes and known TCGA fusions from curated [datasheets](https://github.com/d3b-center/fusion_filtering_pipeline/tree/master/references) . Additionally we also added chimerDB annotation to both driver and prioritised fusion list.

### Clinical Data Harmonization
